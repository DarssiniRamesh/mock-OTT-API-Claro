{"is_source_file": true, "format": "JavaScript", "description": "This file implements caching middleware for an API using Express.js. It provides functions to generate cache keys, check cache conditions, serialize and deserialize response data, and manage the caching process within an Express middleware.", "external_files": ["../services/cache.service", "../utils/logger"], "external_methods": ["cacheService.get", "cacheService.set", "cacheService.deletePattern", "cacheService.delete", "cacheService.getStats", "logger.error", "logger.debug"], "published": ["cacheMiddleware", "routeCache", "clearCache", "invalidateCache", "getCacheStats", "bypassCache"], "classes": [], "methods": [{"name": "_generateCacheKey", "description": "Generates a cache key based on the request method and URL, including the request body for non-GET requests."}, {"name": "_shouldCache", "description": "Determines if a request should be cached based on its method and headers."}, {"name": "_serializeResponse", "description": "Serializes data for caching."}, {"name": "_deserializeResponse", "description": "Deserializes cached response data."}, {"name": "cacheMiddleware", "description": "Creates a middleware function that caches API responses based on specified options."}, {"name": "clearCache", "description": "Clears the cache based on a given pattern."}, {"name": "invalidateCache", "description": "Invalidates a specific cache entry by key."}, {"name": "routeCache", "description": "Creates a route-specific cache middleware function with custom options."}, {"name": "getCacheStats", "description": "Retrieves cache statistics."}, {"name": "bypassCache", "description": "Creates middleware to bypass cache during a request."}, {"name": "json(data)", "scope": "res", "scopeKind": "function", "description": "unavailable"}], "calls": [], "search-terms": ["cache middleware", "API caching", "Express caching"], "state": 2, "file_id": 24, "knowledge_revision": 52, "git_revision": "22ca3b8cbad66d429350d0359fd098789bb9e9d1", "ctags": [{"_type": "tag", "name": "_deserializeResponse", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^const _deserializeResponse = (data) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "_generateCacheKey", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^const _generateCacheKey = (req) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "_serializeResponse", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^const _serializeResponse = (data) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "_shouldCache", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^const _shouldCache = (req) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "baseKey", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^  const baseKey = `${req.method}:${req.originalUrl}`;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "bodyHash", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^    const bodyHash = crypto$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "bypassCache", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^const bypassCache = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "cacheKey", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^    const cacheKey = key(req);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "cacheMiddleware", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^  cacheMiddleware,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "cacheMiddleware", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^const cacheMiddleware = (options = {}) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "cacheService", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^const cacheService = require('..\\/services\\/cache.service');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "cachedResponse", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^    const cachedResponse = cacheService.get(cacheKey);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "clearCache", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^const clearCache = (pattern) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "crypto", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^const crypto = require('crypto');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getCacheStats", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^const getCacheStats = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "invalidateCache", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^const invalidateCache = (key) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "json", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^    res.json = function(data) {$/", "language": "JavaScript", "kind": "function", "signature": "(data)", "scope": "res", "scopeKind": "function"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^const logger = require('..\\/utils\\/logger');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "originalJson", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^    const originalJson = res.json;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "routeCache", "path": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "pattern": "/^const routeCache = (options = {}) => {$/", "language": "JavaScript", "kind": "constant"}], "filename": "/home/kavia/workspace/mock-OTT-API-Claro/src/middleware/cache.middleware.js", "hash": "1552166af278bf6f7ec8befaf008951b", "format-version": 4, "code-base-name": "default", "fields": [{"name": "cacheMiddleware,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"52": "22ca3b8cbad66d429350d0359fd098789bb9e9d1"}]}